pipeline {
agent any
tools {
maven 'M2_HOME'
}
environment {
registry = "ibrahimah/jenkins_file-pipeline"
registrycredential = 'DockerID'
}
stages {
 stage('build') { 
steps {
echo "build step"
sh 'mvn clean'
sh 'mvn install'
sh 'mvn package'
}
}
stages {
 stage('test'){
steps {
echo "test step"
sh 'mvn test'
}
}
stages{ 
 stage('deploy') {
steps {
script {
docker.build registry + ":$BUILD_NUMBER" 
}
}
}
}
}
